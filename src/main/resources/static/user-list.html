<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<title>Lista usuarios</title>

	<link rel="stylesheet" href="./css/normalize.css">

	<link rel="stylesheet" href="./css/bootstrap.min.css">

	<link rel="stylesheet" href="./css/bootstrap-material-design.min.css">

	<link rel="stylesheet" href="./css/all.css">

	<link rel="stylesheet" href="./css/sweetalert2.min.css">

	<script src="./js/sweetalert2.min.js" ></script>

	<link rel="stylesheet" href="./css/jquery.mCustomScrollbar.css">

	<link rel="stylesheet" href="./css/style.css">


</head>
<body>
	<main class="full-box main-container">
		<section class="full-box nav-lateral">
			<div class="full-box nav-lateral-bg show-nav-lateral"></div>
			<div class="full-box nav-lateral-content">
				<figure class="full-box nav-lateral-avatar">
					<i class="far fa-times-circle show-nav-lateral"></i>
					<img src="./imagenes/avatar/Avatar.png" class="img-fluid" alt="Avatar">
					<figcaption class="roboto-medium text-center">
						ANTHONYS PIZZA <br><small class="roboto-condensed-light">Administrador</small>
					</figcaption>
				</figure>
				<div class="full-box nav-lateral-bar"></div>
				<nav class="full-box nav-lateral-menu">
					<ul>
						<li>
							<a href="home.html"><i class="fab fa-dashcube fa-fw"></i> &nbsp; Dashboard</a>
						</li>

						<li>
							<a href="#" class="nav-btn-submenu"><i class="fas fa-pallet fa-fw"></i> &nbsp; Productos <i class="fas fa-chevron-down"></i></a>
							<ul>
								<li>
									<a href="item-new.html"><i class="fas fa-plus fa-fw"></i> &nbsp; Agregar Productos</a>
								</li>
								<li>
									<a href="item-list.html"><i class="fas fa-clipboard-list fa-fw"></i> &nbsp; Lista de Productos</a>
								</li>
								<li>
									<a href="item-search.html"><i class="fas fa-search fa-fw"></i> &nbsp; Buscar Productos</a>
								</li>
							</ul>
						</li>

						<li>
							<a href="#" class="nav-btn-submenu"><i class="fas  fa-user-secret fa-fw"></i> &nbsp; Usuarios <i class="fas fa-chevron-down"></i></a>
							<ul>
								<li>
									<a href="user-new.html"><i class="fas fa-plus fa-fw"></i> &nbsp; Nuevo usuario</a>
								</li>
								<li>
									<a href="user-list.html"><i class="fas fa-clipboard-list fa-fw"></i> &nbsp; Lista de usuarios</a>
								</li>
								<li>
									<a href="user-search.html"><i class="fas fa-search fa-fw"></i> &nbsp; Buscar usuario</a>
								</li>
							</ul>
						</li>
						<li>
							<a href="#" class="nav-btn-submenu"><i class="fas fa-shopping-bag"></i> &nbsp; Pedidos <i class="fas fa-chevron-down"></i></a>
							<ul>
								<li>
									<a href="pedido-new.html"><i class="fas fa-plus fa-fw"></i> &nbsp; Agregar Pedidos</a>
								</li>
								<li>
									<a href="pedido-list.html"><i class="fas fa-clipboard-list fa-fw"></i> &nbsp; Lista de Pedidos</a>
								</li>
								<li>
									<a href="pedido-detail.html"><i class="fas fa-clipboard-list fa-fw"></i> &nbsp; Lista Detalles de Pedidos</a>
								</li>
								<li>
									<a href="pedido-search.html"><i class="fas fa-search fa-fw"></i> &nbsp; Buscar Pedidos</a>
								</li>
							</ul>
						</li>
						<li>
							<a href="#" class="nav-btn-submenu"><i class="fas fa-sliders-h"></i> &nbsp; Categoria Productos <i class="fas fa-chevron-down"></i></a>
							<ul>
								<li>
									<a href="categoria-new.html"><i class="fas fa-plus fa-fw"></i> &nbsp; Agregar Categoria Pedidos</a>
								</li>
								<li>
									<a href="categoria-list.html"><i class="fas fa-clipboard-list fa-fw"></i> &nbsp; Lista de Categorias Pedidos</a>
								</li>
								<li>
									<a href="categoria-search.html"><i class="fas fa-search fa-fw"></i> &nbsp; Buscar Categorias Pedidos</a>
								</li>
							</ul>
						</li>
						<li>
							<a href="#" class="nav-btn-submenu"><i class="fas fa-users"></i> &nbsp; Empleados <i class="fas fa-chevron-down"></i></a>
							<ul>
								<li>
									<a href="empleado-new.html"><i class="fas fa-plus fa-fw"></i> &nbsp; Agregar Empleados</a>
								</li>
								<li>
									<a href="empleado-list.html"><i class="fas fa-clipboard-list fa-fw"></i> &nbsp; Lista de Empleados</a>
								</li>
								<li>
									<a href="item-search.html"><i class="fas fa-search fa-fw"></i> &nbsp; Buscar Empleados</a>
								</li>
							</ul>
						</li>
						<li>
							<a href="#" class="nav-btn-submenu"><i class="fas fa-credit-card"></i> &nbsp; Metodos de Pago<i class="fas fa-chevron-down"></i></a>
							<ul>
								<li>
									<a href="metodoPago-new.html"><i class="fas fa-plus fa-fw"></i> &nbsp; Agregar Metodos de Pago</a>
								</li>
								<li>
									<a href="metodoPago-list.html"><i class="fas fa-clipboard-list fa-fw"></i> &nbsp; Lista de Metodos de Pago</a>
								</li>
								<li>
									<a href="metodoPago-search.html"><i class="fas fa-search fa-fw"></i> &nbsp; Buscar Metodos de Pago</a>
								</li>
							</ul>
						</li>
					</ul>
				</nav>
			</div>
		</section>

		<section class="full-box page-content">
			<nav class="full-box navbar-info">
				<a href="#" class="float-left show-nav-lateral">
					<i class="fas fa-exchange-alt"></i>
				</a>
				<a href="#" class="btn-exit-system">
					<i class="fas fa-power-off"></i>
				</a>
			</nav>

			<div class="full-box page-header">
				<h3 class="text-left">
					<i class="fas fa-clipboard-list fa-fw"></i> &nbsp; LISTA DE USUARIOS
				</h3>
			</div>

			<div class="container-fluid">
				<ul class="full-box list-unstyled page-nav-tabs">
					<li>
						<a href="user-new.html"><i class="fas fa-plus fa-fw"></i> &nbsp; NUEVO USUARIO</a>
					</li>
					<li>
						<a class="active" href="user-list.html"><i class="fas fa-clipboard-list fa-fw"></i> &nbsp; LISTA DE USUARIOS</a>
					</li>
					<li>
						<a href="user-search.html"><i class="fas fa-search fa-fw"></i> &nbsp; BUSCAR USUARIO</a>
					</li>
				</ul>
			</div>

			<div class="container-fluid">
				<div class="table-responsive">
					<table class="table table-dark table-sm">
						<thead>
							<tr class="text-center roboto-medium">
								<th>#</th>
								<th>ID USUARIO</th>
								<th>NOMBRES</th>
								<th>APELLIDOS</th>
								<th>TELEFONO</th>
								<th>CORREO</th>
								<th>CONTRASEÑA</th>
								<th>ACTUALIZAR</th>
								<th>ELIMINAR</th>
							</tr>
						</thead>
						<tbody id="user-table-body">
						</tbody>
					</table>
				</div>

			</div>

		</section>
	</main>
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			console.log('Documento cargado'); // Verificación de carga del documento

			fetch('http://localhost:8080/api/usuarios')
					.then(response => {
						console.log('Respuesta de la API:', response); // Verificación de la respuesta de la API
						if (!response.ok) {
							throw new Error('Error en la respuesta de la API');
						}
						return response.json();
					})
					.then(data => {
						console.log('Datos obtenidos:', data); // Verificación de los datos obtenidos
						const tableBody = document.getElementById('user-table-body');
						if (!Array.isArray(data)) {
							console.error('Los datos obtenidos no son un array:', data);
							return;
						}
						data.forEach((usuario, index) => {
							const row = document.createElement('tr');
							row.className = 'text-center';

							row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${usuario.id}</td>
                        <td>${usuario.nombres}</td>
                        <td>${usuario.apellidos}</td>
                        <td>${usuario.telefono}</td>
                        <td>${usuario.correo}</td>
                        <td>${usuario.contrasena}</td>
                        <td>
                            <a href="user-update.html?id=${usuario.id}" class="btn btn-success">
                                <i class="fas fa-sync-alt"></i>
                            </a>
                        </td>
                        <td>
                            <button class="btn btn-warning" onclick="eliminarUsuario(${usuario.id})">
                                <i class="far fa-trash-alt"></i>
                            </button>
                        </td>
                    `;

							tableBody.appendChild(row);
						});
					})
					.catch(error => console.error('Error al obtener los usuarios:', error));
		});

		function eliminarUsuario(usuarioId) {
			if (confirm('¿Está seguro de que desea eliminar este usuario?')) {
				fetch(`http://localhost:8080/api/usuario/${usuarioId}`, {
					method: 'DELETE',
				})
						.then(response => {
							if (response.ok) {
								console.log('Usuario eliminado:', usuarioId); // Verificación de eliminación
								location.reload();
							} else {
								alert('Error al eliminar el usuario');
							}
						})
						.catch(error => console.error('Error al eliminar el usuario:', error));
			}
			return false;
		}
	</script>



	<!--=============================================
    =            JavaScript files                  =
    ==============================================-->
	<script src="./js/jquery-3.4.1.min.js" ></script>

	<script src="./js/popper.min.js" ></script>

	<script src="./js/bootstrap.min.js" ></script>

	<script src="./js/jquery.mCustomScrollbar.concat.min.js" ></script>

	<script src="./js/bootstrap-material-design.min.js" ></script>
	<script>$(document).ready(function() { $('body').bootstrapMaterialDesign(); });</script>

	<script src="./js/main.js" ></script>
</body>
</html>